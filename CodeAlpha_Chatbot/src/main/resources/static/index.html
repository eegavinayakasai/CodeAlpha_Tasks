<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EVS Chatbot</title>
    <link rel="stylesheet" href="style.css" />
</head>

<body>

<div class="chat-container">
    <div class="top-bar">
        <!-- EVS Chatbot dropdown -->
        <div class="dropdown">
            <button class="drop-button1">EVS Chatbot ⮟</button>

            <div class="dropdown-info1">
                <div class="information">
                    <b><u>About this chatbot</u></b>
                    <p>This chatbot is a Java-based chatbot for interactive communication.</p>
                    <p>It uses Natural Language Processing (NLP) techniques</p>
                </div>
            </div>
        </div>

        <!-- Questions dropdown -->
        <div class="dropdown">
            <button class="drop-button2">Questions you can ask ⮟</button>

            <div class="dropdown-info2">
                <div class="questions">
                    <ol>
                        <li>how are you</li>
                        <li>who are you</li>
                        <li>what can you do</li>
                        <li>are you fine</li>
                        <li>what are you doing</li>
                        <li>what’s up</li>
                        <li>what are you</li>
                        <li>are you human</li>
                        <li>why are you here</li>
                        <li>can you repeat</li>
                        <li>what do you mean</li>
                        <li>who am I</li>
                        <li>what is my name</li>
                        <li>do you know my name</li>
                        <li>you know my name</li>
                        <li>tell me a joke</li>
                        <li>about internship</li>
                        <li>internship duration</li>
                        <li>internship tasks</li>
                        <li>how to use</li>
                        <li>what should I ask</li>
                        <li>what time is it</li>
                        <li>what day is today</li>
                        <li>who made you</li>
                        <li>are you smart</li>
                        <li>do you sleep</li>
                        <li>contact</li>
                        <li>support</li>
                    </ol>
                    <h5>You can ask some casual questions too</h5>
                </div>
            </div>
        </div>
    </div>

    <div class="chat-box" id="chatBox">

        <div class="name"><h1>EVS Chatbot</h1></div>
    </div>

    <div class="chat-input">
        <div class="input-wrapper">
            <textarea class="text" id="userInput" placeholder="Ask anything"></textarea>
            <button class="enterbutton" id="sendBtn">➤</button>
        </div>
    </div>

</div>

<script>
    const chatBox = document.getElementById("chatBox");
    const userInput = document.getElementById("userInput");
    const sendBtn = document.getElementById("sendBtn");

    function addMessage(text, type) {
      const msg = document.createElement("div");
      msg.className = type === "user" ? "message-user" : "message-bot";
      msg.innerText = text;

      chatBox.appendChild(msg);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    async function sendMessage() {
      const message = userInput.value.trim();
      if (message === "") return;

      addMessage(message, "user");
      userInput.value = "";
      const typingDiv = document.createElement("div");
        typingDiv.className = "message-bot";
        typingDiv.innerText = "Typing..."
        chatBox.appendChild(typingDiv);
        chatBox.scrollTop = chatBox.scrollHeight;

      try {
        const response = await fetch("/api/chat", {
          method: "POST",
          headers: { "Content-Type": "text/plain" },
          body: message
        });

        const reply = await response.text();
        const delay = Math.floor(Math.random() * 1000) + 1000; // 1000–2000 ms

    setTimeout(() => {
      typingDiv.remove();
      addMessage(reply, "bot");
    }, delay);


      } catch (err) {
        addMessage("⚠️ Backend not running on port 8080.", "bot");
        console.error(err);
      }
    }

    sendBtn.addEventListener("click", sendMessage);

    userInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });
</script>

</body>
</html>
